<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Org">
  <select id="getInternalPerson">
    SELECT
      mem.seq,
      mem.full_name,
      mem.id,
      mem.avatar_path,
      mem.phone,
      (SELECT name FROM tb_org_structure AS org WHERE org.id = mem.dept_no AND org.`type` = "TYPE::DEPART") as dept_name,
      (SELECT name FROM tb_org_structure AS org WHERE org.id = mem.rank_no AND org.`type` = "TYPE::RANK") as rank_name
    FROM
      tb_member AS mem

    LEFT JOIN
      tb_auth AS auth 
    ON mem.ref_auth_id = auth.id
    <if test="delete_yn != null">
      WHERE
      mem.delete_yn = #{delete_yn}
    </if>
    <if test="inside_yn != null">
      AND
      auth.inside_yn = #{inside_yn}
    </if>
  </select>
</mapper>